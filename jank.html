<!DOCTYPE html>
<html lang="ja">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="css/sample.css">
  <title>Jank</title>
</head>

<body>
  <header>
    <h1>Jank</h1>
  </header>

  <main>
    <ul>
      <li id="gu_btn">グー</li>
      <li id="cho_btn">チョキ</li>
      <li id="par_btn">パー</li>
    </ul>

    <div>自分の出した手は？</div>
    <p id="jibun"></p>

    <div>コンピュータの出した手は？</div>
    <p id="aite"></p>

    <div id="judgment">結果は？</div>

  </main>

  <footer>フッター</footer>


  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  <script>
    $(function () {

      /********************************
       * 定数定義
       ********************************/

      // グーチョキパー
      const JANKEN_HAND_GU = 0;
      const JANKEN_HAND_CHOKI = 1;
      const JANKEN_HAND_PAR = 2;

      // 文字列変換表
      const JANKEN_HAND_TEXT_MTX = [
        'グー',
        'チョキ',
        'パー'
      ];

      //勝ち負けあいこ
      const JANKEN_JUDGE_WIN = 0;
      const JANKEN_JUDGE_LOSS = 1;
      const JANKEN_JUDGE_DRAW = 2;

      // 文字列変換表
      const JANKEN_JUDGE_TEXT_MTX = [
        'かち',
        'まけ',
        'あいこ'
      ];

      // 勝ち負け判定マトリックス
      // 1次元目:自分の手  2次元目:相手の手
      const JANKEN_JUDGE_MTX = [
        // 相手がグー,チョキ,パー
        [JANKEN_JUDGE_DRAW, JANKEN_JUDGE_WIN, JANKEN_JUDGE_LOSS],  //自分がグー
        [JANKEN_JUDGE_LOSS, JANKEN_JUDGE_DRAW, JANKEN_JUDGE_WIN],   //自分がチョキ
        [JANKEN_JUDGE_WIN, JANKEN_JUDGE_LOSS, JANKEN_JUDGE_DRAW]    //自分がパー
      ];

      //IDの連想配列
      const ID_TO_JANKEN_HAND = {
        // なぜか直打ちじゃないと動かない
        '#gu_btn': JANKEN_HAND_GU,
        '#cho_btn': JANKEN_HAND_CHOKI,
        '#par_btn': JANKEN_HAND_PAR
      };

      //乱数のパラメータ
      const min = 0;
      const max = 2;

      //
      // 変数定義
      //
      let myHand;  //自分の手
      let yourHand; //相手の手
      let judge;    //勝敗

      //乱数
      let randomNumber;

      //クリックされた場所を示すID
      let clickID;

      /********************************
       * 自分の手の表記を変える関数
       * @param in inputId  ジャンケンの手
       * @param in outputId 書き変える対象のID
       ********************************/
      function jibunIdToJankenHand(jankenHand, outputId) {
        let jankenTxt = JANKEN_HAND_TEXT_MTX[jankenHand]    //入力されたジャンケンの数値をテキストに変える
        $(outputId).text(jankenTxt);
        return;
      }

      /********************************
       * 相手の手の表記を変える関数
       * @param in jankenHand  ジャンケンの手
       * @param in outputId 書き変える対象のID
       ********************************/
      function aiteIdToJankenHand(jankenHand, outputId) {
        let jankenTxt = JANKEN_HAND_TEXT_MTX[jankenHand]    //入力されたジャンケンの数値をテキストに変える
        $(outputId).text(jankenTxt);
        return;
      }

      /********************************
       * ジャンケン機能 メイン
       ********************************/
      //三つ同時に判定
      $('#gu_btn, #cho_btn, #par_btn').on('click', function () {

        //クリックされたIDを求める
        clickID = '#' + $(this).attr("id");
        //デバッグ出力
        console.log('id  ' + clickID);

        //自分の出した手の表記を変える
        myHand = ID_TO_JANKEN_HAND[clickID];        //入力されたIDをジャンケンの数値に変える
        jibunIdToJankenHand(myHand, '#jibun');


        //相手の手を判定し画面に出力

        //0-2の乱数を求める
        yourHand = Math.floor(Math.random() * max - min + 1) + min;

        aiteIdToJankenHand(yourHand, '#aite')

        //勝敗判定
        judge = JANKEN_JUDGE_TEXT_MTX[JANKEN_JUDGE_MTX[myHand][yourHand]];
        $('#judgment').text(judge);

      })

    });
  </script>

</body>

</html>